# 目录
[TOC]
****
# 一、存储引擎
## 1. MySQL体系结构
![](${currentFileDir}/20230528204729.png)

## 2. 简介
存储引擎就是存储数据、建立索引、更新/查询数据等技术的实现方式。存储引擎是基于表的，而不是基于库的，所以存储引擎也可以被称为表类型。
查询建表语句：
```q
show create table account;
```
查询当前数据库支持的存储引擎：
```q
show engines;
```
在存储表式，指定存储引擎
![](${currentFileDir}/20230528210150.png)

## 3.存储引擎特点
* ### InnoDB
  ![](${currentFileDir}/20230528210559.png)

  ![](${currentFileDir}/20230711135333.png)

  #### 逻辑存储结构
  ![](${currentFileDir}/20230528211203.png)

* ### MyISAM
  ![![](${currentFileDir}/20230528210559.png)](${currentFileDir}/20230711112217.png)
* ### MyISAM
  ![](${currentFileDir}/20230711134746.png)

## 总结
体系结构：连接层、服务层、引擎层、存储层

## 存储引擎选择
![](${currentFileDir}/20230711140014.png)

# 二、索引
xshell上传文件到服务器：rz -y
sudo alien -r

## 1.索引概述
## 2.索引结构
> 数据格式化网站 
###
#### 1.B-tree（多路平衡查找树） 
以一颗最大度数为5（5阶）的b-tree为例（每个节点最多存储4个key，5个指针）：
> 树的度数指的是一个节点的子节点个数。
![](${currentFileDir}/20230904110205.png) 

#### 2.二叉树
选择二叉树作为索引结构存在的缺点：
* 顺序插入时，会形成一个链表，查询性能大大降低
* 大数据量情况下，层级较深，检索速度慢

> 若选择红黑树？
> 红黑树是一颗自平衡二叉树，即使顺序插入数据，最终形成的数据结构也是一颗平衡的二叉树。

#### 3.B+tree
以一颗最大度数为4的b+tree为例：
![](${currentFileDir}/20230904111129.png)

> 与B-Tree区别：
> * 所有数据都会出现在叶子节点上
> * 叶子节点形成一个单向链表

* #### MySQL索引数据结构对经典B+Tree的优化
  增加一个指向相邻叶子节点的链表指针，形成有顺序指针的B+Tree，提高区间访问性能。
  ![](${currentFileDir}/20230904111358.png)

InnoDB存储引擎结构：表空间、段、区、页（默认16k）、行

### 2.Hash哈希索引
哈希索引就是采用一定的hash算法，将键值换算成新的Hash值，映射到对应的槽位上，然后存储在hash表中。
如果两个（或多个）键值，映射到同一槽位上，就产生了hash冲突，可以通过链表解决。
![](${currentFileDir}/20230904112314.png)

> 特点
> * hash索引只能用于对等比较（=，in），不支持范围查询（between，>，<）
> * 无法利用索引完成排序操作
> * 查询效率高，一般一次检索就行，效率通常高于B+Tree索引
### 3.思考
![](${currentFileDir}/20230904113003.png)

## 3.索引分类


## 4.索引语法
创建索引：
![](${currentFileDir}/20230904195036.png)

单列索引与联合索引（取决于括号名字数量）
查看索引：
![](${currentFileDir}/20230904195254.png)

删除索引：
![](${currentFileDir}/20230904195323.png)
## 5.SQL性能分析

## 6.索引使用
/G:查询结果换行
1.验证索引效率：
在未建立索引之前，执行以下查看SQL耗时：
![](${currentFileDir}/20230905110914.png)

针对字段创建索引：
![](${currentFileDir}/20230905110951.png)

再次执行相同语句查看耗时：
![](${currentFileDir}/20230905111003.png)

2.最左前缀法则
![](${currentFileDir}/20230905154328.png)

3.范围查询
联合索引中，出现范围查询，范围查询右侧的列索引失效

4.索引列运算


## 7.索引设计原则

# 三、SQL优化

# 四、视图/存储过程/触发器

# 五、锁

# 六、InnoDB引擎

# 七、MySQL管理